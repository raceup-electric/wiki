# Lavori DV 25/26

Obiettivi generali.
Iniziare a pensare al tempo al giro.
Dinamiche: tutte.


## Generali

### Wiki

Git + obsidian per tutto il team, documenti referneziati fra loro, riferimenti anche al regolamento.
Iniziare a fare report nostri dentro questa wiki.
Task: a. migrare notion esistente, b. scrivere le cose che conosciamo prendendo anche dai doc per gli openbadge.
Documentare un minimo il muletto.

### Muletto

È inutile a testare controlli.
Poco utile a testare odomentria open-loop.
La perception è stateless quindi basta anche da banco.
Per lo SLAM sono sufficenti le bag.
Per il path planning sono abbastanza le simulazioni.
La CAN è completamente diversa dalla 08/09.

Conclusione: può andare in pensione.
Se in velex da 0 fastidio si può tenerlo lì in caso di ripensamenti.

### Depolyment / Test automatici
Non è il massimo pushare su DV stack e fare il pull.
Al momento non conosciamo alternative migliori, chiedere ai SW?

Per deployment e per test automatici potrebbe essere utile studiare la fattibilità di Docker.
Ci sono mille modi per farlo, da studiare.

### CAN

I componenti vari hanno frequenze diverse da quelle teoriche.
È da capire dov'è il problema: tronico / sw / dv.

Esplorare un modo automatico per creare un nodo ROS dal dbc.

### Vi-grade

Com'è possibile che non abbiamo le licenze?!

### Test 08

Testare cose esistenti:
- acceleration: nulla da testare finchè non si fixa il controllo laterale. 
    Il bottleneck per questa cosa è Vi-grade / Luca che sta facendo il longitudinale.
- uno skidpad, anche senza così com'è lo stack.
    Test a velocità crescenti.
- autox/trackdrive: già testato il testabile ad ATA.
    Si potrebbero testare velocità maggiori ma non è priorità.

Testare cose:
- breve termine: aggiustare il laterale e testare acceleration
- medio termine: aggiustare data association dello SLAM e testare trackdrive a velocità più alte
- verso fine anno solare: testare profilo di velocità

### Hardware embedded

Jetson non quest'anno, nemmeno da considerare.
Al 90% non ci serve la GPU in auto agli eventi; i progetti DL sono per lo più esplorativi con esiti incerti.

### ROS

Riusciamo ad aggiornare la versione?
Bottleneck è EUFS.

### Mission handler

Sarebbe meglio se il controllo dello sterzo passasse dalla centralina, per coerenza e per sicurezza.


## Percepion

Macroscopicamente non cambia il sistema, tante piccole migliorie.
Valutare soluzioni DL.

- Stefano va via a metà gennaio
- camere e sensor fusion non si fa quest'anno, si può pensare di iniziare a studiarlo, e/o assegnarlo a un tesista
- refactor codice
- migliorare la posizione del centro del cono, qualcosa di più furbo che uno shift fisso?
- fitting 3D del cono, almeno per i coni vicini, almeno provare se funziona, potrebbe essere utile a rimuovere i falsi positivi (vicini)
- classificazione: usare un po' di ML e sfruttare tutti i punti e tutte le feature lette dal lidar
- bonus: comparare dei coni ufficiali arancioni piccoli
- covarianza: la vera varianza non è data dalla varianza dai singoli punti ma dal fatto che facciamo sampling di una griglia polare
- il lidar balla? a effetto sulla varianza? cercare lato teorico con gli MS/telaio e lato empirico se è possibile modellarla
- ground removal: capire se l'algo attuale può gestire terreni non perfettamente piatti, valutare soluzioni DL
- se avanza tempo, tentare una rete DL su tutta la pointcloud


## Odometria

- i parametri dell'EKF, e forse c'è anche una derivata sbagliata
- l'imu nuovo ha il GPS RTK, va incluso nel EKF
- chiarire se GPS è legale in gara o solo per validazione
- modello dinamico della macchina??!
- gestire un minimo lo slip?
- calcoli della centralina fatti per i VD sarebbe bello averli in CAN, e.g. la velocità


## SLAM

- data association che considera tutta la distribuzione di probabilità
    - distanza melanhobis / most likely association
    - considerare i colori nell'associazione
    - ICP
    - variabile in base alla velocità
- per voto colori pesare i voti con la sicurezza
- loop closure
- verificare se ha senso smettere di mappare dopo il primo giro
- per autox/trackdrive possibilità di caricare la mappa da run precedenti
- esplorare librerie diverse da g2o


## Path Planning

- Al secondo giro con la mappa disponibile, fare il path più lungo per avere input migliori a velocity profile / controlli.

- Il path planning attuale è robusto.
    È limitato alla center line, ma a migliorare la racing line si migliora di poco rispetto il resto, il tracciato è largo 3m.
    La center line è anche quella che ti fa tirar giù meno coni.

- A bassa priorità e difficilmente in macchina quest'anno.
    Iniziare a fare un nostro path planning in ottica di ottimizare racing line:
    - via di mezzo, si tengono i primi due moduli di fasttube (sorting + matching) e riscrivere il modulo della traiettoria (python)
    - meglio a lungo termine riscriverlo da zero in C++, copiando gli algoritmi dei primi due moduli e da zero il terzo


## Velocity Profile

- nuovo nodo ROS, riceve il path planning e produce percentuale di acceleratore/freno
- ci lavora Luca per la tesi
- serve un buon modello dinamico della macchina


## Controlli

- Longitudinale.
    Prima che arrivi velocity profile la rampa per ora va bene.
    Arrivato il velocity profile è da riscrivere da zero con un PID.
    Tuning e simulazioni.

- Stanley.
    Aggiungere componente integrativa.
    Tuning e simulazioni.

- Pure Pursuit.
    Va sviluppato e tunato.
    Poi si fa un confronto su quale dei due da risultati migliori, su ogni tipo di dinamica.
    Se lo Stanley funziona molto bene si può non fare.

- DVD.
    I controllisti si faranno un po' di lezioni dai VD.
    Alcuni modelli sono in comune fra i due reparti, non ha senso lavorare due volte.

- MPC.
    Indispensabile per le alte velocità, non sappiamo ancora qual è il limite di longitudinale+laterale.
    Con Vi-grade bisogna capire questo limite al più presto.
    Bisogna iniziare a lavorare a un MPC cinematico non più tardi di gennaio, con l'idea che possa essere messo in macchina.
    Sarebbe utile avere (almeno) un tesista che lavori in parallelo/insieme a noi; non è un lavoro da lasciare esclusivamente ai tesisti altrimenti non finirà in macchina.
    Tanta ricerca da fare lato nostro.
    Serviranno molti confronti con Bruschetta ed eventualmente con Beghi.


## Recruitment

### Persone

Quattro persone, per la parte iniziale dell'anno non saranno produttivi ma da istruire su:

1. perception,
2. odometry/slam,
3. path planning/velocity profile,
4. controlli;

poi per i lavori da fare si decide quando iniziano a diventare produttivi.

Al recruitment non cercherei conoscenze specifiche ma persone in gamba, cercando di prendere però:

- una persona che sappia già qualcosa di controlli;
- una persona smanettona con linux/hardware.

### Assignement

Due assignment, uno più algoritmico e l'altro sui controlli.
Wish: assignment semplice, ma che si presti al colloquio per chiedere di aggiungere/modificare qualcosa di non banale, così se non è farina del suo sacco si capisce.

### Colloqui

Cercare un colloquio un po' più fluido/scorrevole.
Con candidati interessanti si può considerare una ciaccola informale fuori dal colloquio.
